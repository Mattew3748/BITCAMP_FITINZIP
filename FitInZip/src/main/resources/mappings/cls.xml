<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="class">
	
	<!-- 페이징을 위한 쿼리 -->
	<select id="getListWithPaging" resultType="ClsVO" parameterType="com.spring.FitInZip.back.cls.clsStatus.Criteria">
		<![CDATA[
			select *
			from
			    (select /*+INDEX_DESC(FIT_CLASS FIT_CLASS_PK) */ rownum rn, CLS_CODE, TRAINER_ID, CLS_CATEGORY, CLS_NAME, CLS_TAG, START_DATE,
			        END_DATE, YOIL, START_TIME, END_TIME, LAPSE, CLS_LEVEL, EQUIP, PER_PRICE, CLS_INFO, CURRICULUM, CLS_ORI_NAME, CLS_FILE_NAME,
			        CLS_STATUS, MAX_MEM, CALORIE, MEET_URL
			    from fit_class
			    where rownum <= #{pageNum} * #{amount} and trainer_id = #{trainerId})
			where rn > (#{pageNum} -1) * #{amount} and trainer_id = #{trainerId}
		]]>
	</select>
	
	<!-- 주문번호 생성을 위한 시퀀스 select -->
	<select id="getClassSeq" resultType="String">
		SELECT class_seq.NEXTVAL seq_num FROM dual
	</select>
	
	<!-- 강의 등록 -->
	<insert id="regClass" parameterType="ClsVO">
		insert into fit_class
		values(#{clsCode}, #{trainerId}, #{clsCategory}, #{clsName}, 
		#{clsTag}, #{startDate}, #{endDate}, #{yoil}, <![CDATA[to_timestamp(#{startTime, jdbcType=TIMESTAMP}]]>, 'hh24:mi:ss'), to_timestamp(#{endTime, jdbcType=TIMESTAMP}, 'hh24:mi:ss'), #{lapse}, #{clsLevel}, #{equip}, #{perPrice}, #{clsInfo},
		#{curriculum}, #{clsOriName}, 'upload', #{clsStatus}, #{maxMem}, #{calorie}, #{meetUrl})
	</insert>
	
	<!-- 수정을 위한 강의 불러오기 -->
	<select id="selectClassForMod" parameterType="clsVO" resultType="clsVO">
		select *
		from fit_class
		where cls_code = #{clsCode} and trainer_id = #{trainerId}
	</select>
	
</mapper>